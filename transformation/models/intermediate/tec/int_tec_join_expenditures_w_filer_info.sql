with EXPENDITURES AS (
    SELECT * 
    FROM {{ref('stg_tec__expenditures')}}
    WHERE YEAR(EXPEND_DT) >= '2023'
)
SELECT
    EXPENDITURES.RECORD_TYPE,
    EXPENDITURES.FORM_TYPE_CD,
    EXPENDITURES.SCHED_FORM_TYPE_CD,
    CANDIDATES.CHOICE_NAME,
    FILERS.FILER_NAME_FIRST,
    FILERS.FILER_NAME_LAST,
    FILERS.FILER_NAME_SHORT,
    CANDIDATES.CONTEST_NAME             AS OFFICE_SOUGHT,
    CANDIDATES.PARTY_NAME,
    EXPENDITURES.REPORT_INFO_IDENT,
    EXPENDITURES.RECEIVED_DT,
    EXPENDITURES.INFO_ONLY_FLAG,
    EXPENDITURES.FILER_IDENT,
    EXPENDITURES.FILER_TYPE_CD,
    EXPENDITURES.EXPEND_INFO_ID,
    EXPENDITURES.EXPEND_DT,
    EXPENDITURES.EXPEND_AMOUNT,
    EXPENDITURES.EXPEND_DESCR,
    EXPENDITURES.ITEMIZE_FLAG,
    EXPENDITURES.TRAVEL_FLAG,
    EXPENDITURES.EXPEND_CAT_CD,
    EXPENDITURES.EXPEND_CAT_DESCR,
    EXPENDITURES.POLITICAL_EXPEND_CD,
    EXPENDITURES.REIMBURSE_INTENDED_FLAG,
    EXPENDITURES.SRC_CORP_CONTRIB_FLAG,
    EXPENDITURES.CAPITAL_LIVINGEXP_FLAG,
    EXPENDITURES.PAYEE_PERSENT_TYPE_CD,
    EXPENDITURES.PAYEE_FULL_NAME,
    EXPENDITURES.PAYEE_NAME_ORGANIZATION,
    EXPENDITURES.PAYEE_NAME_FIRST,
    EXPENDITURES.PAYEE_NAME_LAST,
    EXPENDITURES.PAYEE_NAME_SUFFIX_CD,
    EXPENDITURES.PAYEE_NAME_PREFIX_CD,
    EXPENDITURES.PAYEE_NAME_SHORT,
    EXPENDITURES.PAYEE_STREET_ADDR1,
    EXPENDITURES.PAYEE_STREET_ADDR2,
    EXPENDITURES.PAYEE_STREET_CITY,
    EXPENDITURES.PAYEE_STREET_STATE_CD,
    EXPENDITURES.PAYEE_STREET_COUNTY_CD,
    EXPENDITURES.PAYEE_STREET_COUNTRY_CD,
    EXPENDITURES.PAYEE_STREET_POSTAL_CODE,
    EXPENDITURES.PAYEE_STREET_REGION,
    EXPENDITURES.CREDIT_CARD_ISSUER,
    EXPENDITURES.REPAYMENT_DT,
    EXPENDITURES.SOURCE_FILE_NAME
FROM EXPENDITURES
LEFT JOIN {{ ref('stg_dced__dallas_county_primary_elections') }} CANDIDATES
    ON EXPENDITURES.FILER_IDENT = CANDIDATES.TEC_FILER_IDENT
JOIN (SELECT 
        FILER_IDENT, 
        FILER_NAME_FIRST, 
        FILER_NAME_SHORT, 
        FILER_NAME_LAST, 
        FILER_TYPE_CD,
        CTA_SEEK_OFFICE_CD,
        CTA_SEEK_OFFICE_DISTRICT
    FROM {{ref('stg_tec__filer_info')}}
    WHERE
        (FILER_IDENT = '00082094') OR
        (FILER_IDENT = '00088326') OR
        (FILER_IDENT = '00083877' AND CTA_SEEK_OFFICE_CD= 'PARTYCHAIRCO') OR
        (FILER_IDENT = '00082184') OR
        (FILER_IDENT = '00081730') OR
        (FILER_IDENT = '00062309') OR
        (FILER_IDENT = '00083383') OR
        (FILER_IDENT = '00083240') OR
        (FILER_IDENT = '00087886') OR
        (FILER_IDENT = '00057485') OR
        (FILER_IDENT = '00041408') OR
        (FILER_IDENT = '00088125') OR
        (FILER_IDENT = '00088247') OR
        (FILER_IDENT = '00066111') OR
        (FILER_IDENT = '00087802') OR
        (FILER_IDENT = '00058136' AND CTA_SEEK_OFFICE_CD = 'JUSTICE_SC') OR
        (FILER_IDENT = '00087764') OR
        (FILER_IDENT = '00087936') OR
        (FILER_IDENT = '00082452') OR
        (FILER_IDENT = '00080031') OR
        (FILER_IDENT = '00030098') OR
        (FILER_IDENT = '00088187') OR
        (FILER_IDENT = '00081859') OR
        (FILER_IDENT = '00081788') OR
        (FILER_IDENT = '00088232') OR
        (FILER_IDENT = '00082446') OR
        (FILER_IDENT = '00062484') OR
        (FILER_IDENT = '00055113') OR
        (FILER_IDENT = '00067708') OR
        (FILER_IDENT = '00087000') OR
        (FILER_IDENT = '00069742') OR
        (FILER_IDENT = '00085730') OR
        (FILER_IDENT = '00070992') OR
        (FILER_IDENT = '00020591') OR
        (FILER_IDENT = '00082027') OR
        (FILER_IDENT = '00088193') OR
        (FILER_IDENT = '00038111' AND CTA_SEEK_OFFICE_CD = 'JUDGE_COCA') OR
        (FILER_IDENT = '00088057') OR
        (FILER_IDENT = '00088174') OR
        (FILER_IDENT = '00082237') OR
        (FILER_IDENT = '00087349') OR
        (FILER_IDENT = '00088335') OR
        (FILER_IDENT = '00037146') OR
        (FILER_IDENT = '00086488') OR
        (FILER_IDENT = '00082026') OR
        (FILER_IDENT = '00084421') OR
        (FILER_IDENT = '00068006' AND CTA_SEEK_OFFICE_CD = 'JUSTICE_SC') OR
        (FILER_IDENT = '00026739' AND CTA_SEEK_OFFICE_CD = 'JUSTICE_SC') OR
        (FILER_IDENT = '00086370') OR
        (FILER_IDENT = '00088239') OR
        (FILER_IDENT = '00087718') OR
        (FILER_IDENT = '00088158') OR
        (FILER_IDENT = '00087226') OR
        (FILER_IDENT = '00087697') OR
        (FILER_IDENT = '00088068') OR
        (FILER_IDENT = '00087800') OR
        (FILER_IDENT = '00062111') OR
        (FILER_IDENT = '00069299') OR
        (FILER_IDENT = '00087197') OR
        (FILER_IDENT = '00088356') OR
        (FILER_IDENT = '00088227') OR
        (FILER_IDENT = '00088300') OR
        (FILER_IDENT = '00086203') OR
        (FILER_IDENT = '00087763') OR
        (FILER_IDENT = '00051444' AND CTA_SEEK_OFFICE_CD = 'JUSTICE_COA') OR
        (FILER_IDENT = '00067429') OR
        (FILER_IDENT = '00080944') OR
        (FILER_IDENT = '00069344') OR
        (FILER_IDENT = '00086397') OR
        (FILER_IDENT = '00081605') OR
        (FILER_IDENT = '00058399' AND CTA_SEEK_OFFICE_CD = 'STATESEN') OR
        (FILER_IDENT = '00067922') OR
        (FILER_IDENT = '00051772') OR
        (FILER_IDENT = '00088299') OR
        (FILER_IDENT = '00054808') OR
        (FILER_IDENT = '00069652') OR
        (FILER_IDENT = '00088388') OR
        (FILER_IDENT = '00080443') OR
        (FILER_IDENT = '00082014') OR
        (FILER_IDENT = '00051519') OR
        (FILER_IDENT = '00020990') OR
        (FILER_IDENT = '00069780') OR
        (FILER_IDENT = '00087736') OR
        (FILER_IDENT = '00026509') OR
        (FILER_IDENT = '00069606') OR
        (FILER_IDENT = '00088140') OR
        (FILER_IDENT = '00088343') OR
        (FILER_IDENT = '00069649') OR
        (FILER_IDENT = '00082440') OR
        (FILER_IDENT = '00067987') OR
        (FILER_IDENT = '00065784') OR
        (FILER_IDENT = '00085976') OR
        (FILER_IDENT = '00086182') OR
        (FILER_IDENT = '00080065') OR
        (FILER_IDENT = '00082438') OR
        (FILER_IDENT = '00088123') OR
        (FILER_IDENT = '00019811'))FILERS
ON TRIM(EXPENDITURES.FILER_IDENT) = TRIM(FILERS.FILER_IDENT)
AND TRIM(EXPENDITURES.FILER_TYPE_CD) = TRIM(FILERS.FILER_TYPE_CD)